# 常见加密算法剖析实现

## AES(EBC模式)

~~~c++
#include <iostream>
using namespace std;
//加密编码过程函数,16位1和0
int dataLen = 16;   //需要加密数据的长度
int encLen = 4;     //加密分段的长度
int encTable[4] = {1,0,1,0};  //置换表
int data[16] = {1,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0}; //明文
int ciphertext[16]; //密文

void encode(int arr[]) //切片加密，亦或加密,跟置换表进行亦或
{
    for (int i = 0; i < encLen; ++i) {
        arr[i] = arr[i] ^ encTable[i];
    }
}
void EBC(int arr[])
{
    int a[4][4];
    int dataCount = 0;
    for (int k = 0; k < 4; ++k) { //要加密的数据被分为4组
        for (int t = 0; t < 4; ++t) { //
            a[k][t] = data[dataCount];
            dataCount++;
        }
    }
    dataCount=0; 
    for (int i = 0; i <dataLen; i=i+encLen) {
        int r = i/encLen; //0,1,2,3,
        int l = 0; //列
        int encQue[4];  //数据片段
        for (int j = 0; j <encLen; ++j) { //每一组都轮流放入数据片段
                encQue[j] = a[r][l];
                l++;
        }
        encode(encQue); //每一组都进行加密运算
        for (int p = 0; p < encLen; ++p) {
            ciphertext[dataCount] = encQue[p]; //放置到密文表里面。
            dataCount++;
        }
    }
    cout<<"EBC密文为："<<endl; //输出密文。
    for (int tl = 0; tl < dataLen; ++tl) {
        if(tl!=0&&tl%4==0)
        {
            cout<<endl;
        }
        cout<<ciphertext[tl]<<" ";
    }
    cout<<endl;
    cout<<"----------------------"<<endl;
}
int main() {
    std::cout << "Hello, World!" << std::endl;
    return 0;
}
~~~

可以看到该加密的核心在于置换表和切片加密的加密算反。

> 改方式为对称加密方式，所以其加密算法和解密算法相同。

